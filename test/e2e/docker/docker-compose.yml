version: "3.8"

services:
  ubuntu-test:
    build:
      context: .
      dockerfile: ubuntu.Dockerfile
    container_name: superviz-e2e-ubuntu
    ports:
      - "2201:22"
    networks:
      - superviz-e2e
    healthcheck:
      test: ["CMD", "nc", "-z", "localhost", "22"]
      interval: 10s
      timeout: 5s
      retries: 3
      start_period: 30s

  debian-test:
    build:
      context: .
      dockerfile: debian.Dockerfile
    container_name: superviz-e2e-debian
    ports:
      - "2202:22"
    networks:
      - superviz-e2e
    healthcheck:
      test: ["CMD", "nc", "-z", "localhost", "22"]
      interval: 10s
      timeout: 5s
      retries: 3
      start_period: 30s

  alpine-test:
    build:
      context: .
      dockerfile: alpine.Dockerfile
    container_name: superviz-e2e-alpine
    ports:
      - "2203:22"
    networks:
      - superviz-e2e
    healthcheck:
      test: ["CMD", "nc", "-z", "localhost", "22"]
      interval: 10s
      timeout: 5s
      retries: 3
      start_period: 30s

  centos-test:
    build:
      context: .
      dockerfile: centos.Dockerfile
    container_name: superviz-e2e-centos
    ports:
      - "2204:22"
    networks:
      - superviz-e2e
    healthcheck:
      test: ["CMD", "nc", "-z", "localhost", "22"]
      interval: 10s
      timeout: 5s
      retries: 3
      start_period: 30s

  fedora-test:
    build:
      context: .
      dockerfile: fedora.Dockerfile
    container_name: superviz-e2e-fedora
    ports:
      - "2205:22"
    networks:
      - superviz-e2e
    healthcheck:
      test: ["CMD", "nc", "-z", "localhost", "22"]
      interval: 10s
      timeout: 5s
      retries: 3
      start_period: 30s

  arch-test:
    build:
      context: .
      dockerfile: arch.Dockerfile
    container_name: superviz-e2e-arch
    ports:
      - "2206:22"
    networks:
      - superviz-e2e
    healthcheck:
      test: ["CMD", "nc", "-z", "localhost", "22"]
      interval: 10s
      timeout: 5s
      retries: 3
      start_period: 30s

networks:
  superviz-e2e:
    driver: bridge
